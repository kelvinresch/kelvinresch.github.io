<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Fast Robots Spring 2025 - Kelvin Resch</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/robot.ico" />
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <!-- Prism.js CSS for Syntax Highlighting -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    </head>
    <body>
        <!-- Prism.js JavaScript -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.js"></script>
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-cpp.min.js"></script>  -->
        <!-- Responsive navbar-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-danger">
            <div class="container px-lg-5">
                <a class="navbar-brand" href="https://kelvinresch.github.io">Lab 1</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                        <li class="nav-item"><a class="nav-link active" aria-current="page" href="https://kelvinresch.github.io">Home</a></li>
                        <li class="nav-item"><a class="nav-link" href="https://www.linkedin.com/in/kelvin-resch">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Header-->
        <header class="py-5">
            <div class="container px-lg-5">
                <div class="p-4 p-lg-5 bg-light rounded-3 text-center">
                    <div class="m-4 m-lg-5">
                        <h1 class="display-5 fw-bold">Lab 2</h1>
                        <p class="fs-4">This lab integrates IMU sensor data into the bluetooth data reporting infrastructure</p>
                    </div>
                </div>
            </div>
        </header>

<!-- Page Content-->
        <section class="pt-4">
            <div class="container px-lg-5">
                <!-- Single Bootstrap Card -->
                <div class="card bg-light border-0">
                    <div class="card-body p-4 p-lg-5">
                        <!-- Card Content -->
                        <h1 class="card-title text-center mb-4">Setting up the IMU</h1>
                        <p class="card-text">
                            After downloading the ICM 20948 library in the Arduino IDE, connecting up the IMU, and opening the Lecture 4
                            demo code, I could retrieve IMU data. This is what my setup looked like:
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.1.jpg" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <p class="card-text">
                            By opening up the serial monitor, I can view the stream of data coming in from the IMU though the Artemis board.
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.2.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <h2 class="card-title text-center mb-4">AD0_val</h2>
                        <p class="card-text">
                            I have set up my IMU to communicate with the Artemis over I2C, which requires each peripheral to have an address.
                            The IMU has a default I2C address of 0bxxxxxx1, and if I short the ADR jumper pads on the back of the IMU, I can set the I2C 
                            address to be 0bxxxxxx0. Basically, this determines what the last bit of the IMU's I2C address is. According to 
                            <a href="https://www.sparkfun.com/sparkfun-9dof-imu-breakout-icm-20948-qwiic.html" target="_blank" 
                            rel="noopener noreferrer">Sparkfun's website</a>, the full I2C address is 0x69 normally, and 0x68 with 
                            the jumper, which is consistent with AD0_val's behavior.
                        </p>
                        <h2 class="card-title text-center mb-4">Acceleration and Gyro data</h2>
                        <p class="card-text">
                            The acceleration data is reported in units of milli-g. When I hold the accelerometer flat against the
                            table, the x and y axes read zero acceleration, and the z-axis reads 1000 milli-g of acceleration, which
                            is consistent with what I expect, as the acceleration of gravity is acting on the MEMS sensor.
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.3.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <p class="card-text">
                            When I rotate the IMU, the x and y axes change, and the z-axis decreases. If I put the IMU on its side,
                            the y-axis goes to 1000 and the other axes go to 0. This means that the y-axis of the IMU is pointing
                            downwards (the direction of gravity's acceleration).
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.4.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <p class="card-text">
                            To validate gyro data, I rotated the IMU along the x axis. As I rotate along the right hand rule, the
                            pitch angle is positive, and as I go the other way, the pitch angle is negative. This 
                            is consistent with expectations.
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.5.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <p class="card-text">
                            One issue with gryoscope data is that it has drift. The IMU chip reports angular velocity in degrees per second,
                            and I'm integrating that over time to get the angle. The data has low noise but high drift due to this integral. 
                        </p>
                        <p class="card-text">
                            To prevent this drift, I can use atan2() with the accelerometer data to report a driftless measurement of pitch and roll.
                            This idea takes advantage of that fact that on Earth, we constantly have an acceleration vector of length 1 g pointing downwards.
                            By evaluating the components of the gravity vector along the x and y axes, we can get an absolute measurement of pitch and yaw.
                            Unfortunately, since the yaw axis points along the gravity vector, we cannot determine yaw with this method. 
                        </p>
                        <p class="card-text">
                            You can see that the roll data from both the accelerometer and gyroscope agree at 90 degrees. However, if I move the 
                            IMU around, the gyroscope will eventually diverge from the accelerometer data.
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.6.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        <p class="card-text">
                            The drawback of using the accelerometer to measure pitch and roll is that noise increases severely near 90 degrees. 
                            This is a result of atan2 being poorly conditioned around accel_z = 0. If I expect the car to need pitch and roll measurements
                            near 90 degrees, I would not use this data in that operating condition. You can see in the below picture how 
                            noisy pitch_a gets here.
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.7.png" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="pt-4">
            <div class="container px-lg-5">
                <!-- Single Bootstrap Card -->
                <div class="card bg-light border-0">
                    <div class="card-body p-4 p-lg-5">
                        <!-- Card Content -->
                        <h1 class="card-title text-center mb-4">Acceleration</h1>
                        <p class="card-text">
                            After downloading the ICM 20948 library in the Arduino IDE, connecting up the IMU, and opening the Lecture 4
                            demo code, I could retrieve IMU data. This is what my setup looked like:
                        </p>
                        <!-- Embedded Image -->
                        <div class="text-center mb-4">
                            <img src="assets/Lab2/IMU_setup 1.1.jpg" alt="Echo Example Image" class="img-fluid rounded-3" style="max-width: 100%; height: auto;">
                        </div>
                        
                    </div>
                </div>
            </div>
        </section>
        <!-- Footer-->
        <footer class="py-5 bg-dark">
            <div class="container"><p class="m-0 text-center text-white">Copyright &copy; Kelvin Resch 2025</p></div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
